<!doctype html>
<html lang="en"><head>
    <title>Plug-in System of Golang</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="Go的插件机制" />

    
    
    
    <link rel="stylesheet" href="../../css/theme.min.css">

    
    
    

    

</head>
<body>
        <div id="content" class="mx-auto"><header class="container mt-sm-5 mt-4 mb-4 mt-xs-1">
    <div class="row">
        <div class="col-sm-4 col-12 text-sm-right text-center pt-sm-4">
            <a href="../../" class="text-decoration-none">
                <img id="home-image" class="rounded-circle"
                    
                        
                            src="../../images/avatar.jpg"
                        
                    
                />
            </a>
        </div>
        <div class="col-sm-8 col-12 text-sm-left text-center">
            <h2 class="m-0 mb-2 mt-4">
                <a href="../../" class="text-decoration-none">
                    
                        Suen ChunYu
                    
                </a>
            </h2>
            <p class="text-muted mb-1">
                
                    Development Manager | Kyotta | Haidian, Beijing
                
            </p>
            <ul id="nav-links" class="list-inline mb-2">
                
                
                    <li class="list-inline-item">
                        <a class="badge badge-white " href="../../about/" title="关于我">关于我</a>
                    </li>
                
                    <li class="list-inline-item">
                        <a class="badge badge-white " href="../../post/" title="文章">文章</a>
                    </li>
                
                    <li class="list-inline-item">
                        <a class="badge badge-white " href="../../categories/" title="分类">分类</a>
                    </li>
                
            </ul>
            <ul id="nav-social" class="list-inline">
                
                    <li class="list-inline-item mr-3">
                        <a href="https://github.com/suenchunyu" target="_blank">
                            <i class="fab fa-github fa-1x text-muted"></i>
                        </a>
                    </li>
                
                    <li class="list-inline-item mr-3">
                        <a href="https://www.linkedin.com/in/%E6%8C%AF%E5%AE%87-%E5%AD%99-7b0842142/" target="_blank">
                            <i class="fab fa-linkedin-in fa-1x text-muted"></i>
                        </a>
                    </li>
                
                    <li class="list-inline-item mr-3">
                        <a href="https://twitter.com/suenchunyu" target="_blank">
                            <i class="fab fa-twitter fa-1x text-muted"></i>
                        </a>
                    </li>
                
                    <li class="list-inline-item mr-3">
                        <a href="mailto:sunzhenyucn@gmail.com" target="_blank">
                            <i class="fas fa-at fa-1x text-muted"></i>
                        </a>
                    </li>
                
            </ul>
        </div>
    </div>
    <hr />
</header>
<div class="container">
    <div class="pl-sm-2">
        <div class="mb-3">
            <h3 class="mb-0">Plug-in System of Golang</h3>
            
            <small class="text-muted">Published February 1, 2021</small>
        </div>

        <article>
            <blockquote>
<p>Go语言的开发者一般关注点更多的会放在其比较热门的特性上，例如：Goroutine、GPM和Channel等，但Go提供的远远不止这些，其中的插件机制和CGO相对来说都是比较少关注的Features，通过插件机制可以实现构建松散耦合的模块化程序。</p>
</blockquote>
<h2 id="1-设计原理">1. 设计原理</h2>
<p>Go的插件机制基于的是C语言的动态库机制实现的，所以本身Go直接继承了C语言动态库的优缺点；在Linux中一般会碰<strong>静态链接库</strong>和<strong>动态库</strong>两种，它们各自的特点和优势大不相同，我们一般要结合实际场景酌情选择：</p>
<ul>
<li>静态库（静态链接库）：一般是由开发者自定的变量和函数构成，其构成简单，不像动态链接库那么复杂，在编译期间一般由编译器或者链接器将它们集成到目标程序内，并打包制作成可独立运作的可执行文件。</li>
<li><a href="https://zh.wikipedia.org/wiki/%E5%87%BD%E5%BC%8F%E5%BA%AB#%E5%8A%A8%E6%80%81%E5%BA%93">动态库（共享对象）</a>：和Windows的<a href="https://zh.wikipedia.org/wiki/Dynamic_Link_Library">动态链接库</a>不同，在Unix或者Linux环境下是共享对象（共享库），预先编译链接好的可执行文件，程序在使用这些库时是从共享对象中加载，而不是在编译期间打包进程序。</li>
</ul>
<p>由于特性的不同，动态库和静态库的优缺点也就非常明显；只依赖静态库并通过静态链接的二进制程序可以独立执行，但是由于编译后的结果包含了全部的依赖，这就导致编译后的结果比较大；而动态库往往是在多个可执行文件之间共享，加载动态库的过程也是在装载时（Load-Time）加载，大多数情况下同一时间多个应用可以使用一个库的同一份拷贝，系统并不需要加载这个库的多个实例，极大的降低了内存的占用。</p>
<p><img src="https://suenchunyu.dev/static/libraries.png" alt="Libraries"></p>

        </article>
    </div>

            </div>
        </div><footer class="text-center pb-1">
    <small class="text-muted">
        
            &copy; Copyright 2021, Suen ChunYu
        
        <br>
        Powered by <a href="https://gohugo.io/" target="_blank">Hugo</a>
        and <a href="https://github.com/austingebauer/devise" target="_blank">Devise</a>
    </small>
</footer>
</body>
</html>
